question,query,db_name,query_category
"Which authors have written publications in both the domain ""Machine Learning"" and the domain ""Data Science""?","SELECT {author.name,author.aid} FROM author WHERE author.aid IN (   SELECT domain_author.aid   FROM domain_author   WHERE domain_author.did IN (     SELECT domain.did     FROM domain     WHERE domain.name IN ('Machine Learning', 'Data Science')   )   GROUP BY 1   HAVING COUNT(DISTINCT domain_author.did) = 2 );",academic,group_by
What is the average number of citations received by publications in each year?,"SELECT publication.year, AVG(publication.citation_num) AS average_citations FROM publication GROUP BY publication.year ORDER BY publication.year NULLS LAST;",academic,group_by
What is the total number of publications that cite each publication?,"WITH cited_pubs AS (SELECT cite.cited AS publication_id, COUNT(*) AS total_citations FROM cite GROUP BY cite.cited ORDER BY total_citations DESC NULLS LAST) SELECT COUNT(*) FROM cited_pubs WHERE total_citations > 0;",academic,group_by
What is the total number of publications published in each year?,"SELECT publication.year, COUNT(DISTINCT publication.pid) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year;",academic,group_by
What is the average number of references cited by publications in each domain name?,"SELECT {domain.name,domain.did}, AVG(publication.reference_num) as average_references FROM domain_publication JOIN publication ON domain_publication.pid = publication.pid JOIN domain ON domain.did = domain_publication.did GROUP BY 1;",academic,group_by
What are the top 3 publications with the highest number of citations?,"SELECT publication.title, publication.citation_num FROM publication ORDER BY publication.citation_num DESC LIMIT 3;",academic,order_by
What is the title of the publication that has received the highest number of citations?,SELECT publication.title FROM publication ORDER BY publication.citation_num DESC NULLS LAST LIMIT 1;,academic,order_by
What are the titles of all publications ordered alphabetically?,SELECT DISTINCT publication.title  FROM publication  ORDER BY publication.title ASC NULLS LAST;,academic,order_by
"What are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order?","SELECT publication.title, publication.reference_num FROM publication ORDER BY publication.reference_num DESC LIMIT 3;",academic,order_by
What are the top 5 domains with the highest number of authors associated with them?,"SELECT d.name, COUNT(DISTINCT a.aid) as author_count FROM author a JOIN domain_author da ON a.aid = da.aid JOIN domain d ON da.did = d.did GROUP BY d.name ORDER BY author_count DESC, d.name LIMIT 5;",academic,order_by
What is the ratio of publications to authors in the database?,"SELECT    CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS publication_to_author_ratio FROM    publication, author;",academic,ratio
How does the ratio of publications to keywords vary across different domains?,"SELECT domain_publication.did,         CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_publication JOIN domain_keyword ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;",academic,ratio
How does the ratio of authors to organizations differ by continent?,"SELECT organization.continent,         COUNT(DISTINCT author.aid)::float / NULLIF(COUNT(DISTINCT organization.oid), 0) AS ratio FROM author JOIN organization ON author.oid = organization.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST;",academic,ratio
How does the ratio of publications to journals change over the years? Return the annual numbers of publications and journals as well.,"SELECT    publication.year,    COUNT(DISTINCT publication.pid) AS num_publications,    COUNT(DISTINCT publication.jid) AS num_journals,    CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT publication.jid), 0) AS ratio FROM    publication GROUP BY    publication.year ORDER BY    publication.year;",academic,ratio
What is the ratio of publications presented in conferences to publications published in journals?,"SELECT    CAST(COUNT(DISTINCT publication.cid) AS FLOAT) / NULLIF(COUNT(DISTINCT publication.jid), 0) AS ratio FROM    publication;",academic,ratio
"How many publications were presented at each conference, ordered by the number of publications in descending order? Give the names of the conferences and their corresponding number of publications.","SELECT conference.name, COUNT(publication.pid) AS num_publications FROM publication JOIN conference ON publication.cid=conference.cid GROUP BY conference.cid ORDER BY num_publications DESC NULLS LAST;",academic,table_join
"What is the total number of publications in each journal, ordered by the number of publications in descending order?","SELECT journal.name, COUNT(publication.pid) AS total_publications FROM publication JOIN journal ON publication.jid=journal.jid GROUP BY journal.name ORDER BY total_publications DESC NULLS LAST;",academic,table_join
How does the ratio of citations to publications vary across different domains?,"SELECT domain.name,         SUM(publication.citation_num)::float / NULLIF(COUNT(DISTINCT domain_publication.pid), 0) AS citation_to_publication_ratio FROM domain JOIN domain_publication ON domain.did = domain_publication.did JOIN publication ON domain_publication.pid = publication.pid GROUP BY domain.name ORDER BY citation_to_publication_ratio DESC NULLS LAST;",academic,table_join
Which author had the most publications in the year 2021?,"SELECT author.name, COUNT(publication.pid) AS publication_count FROM writes JOIN author ON writes.aid = author.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY author.name ORDER BY publication_count DESC NULLS LAST LIMIT 1; ",academic,table_join
What is the total number of publications presented in each conference?,"SELECT conference.name, COUNT(publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY conference.name ORDER BY total_publications DESC;",academic,table_join
Which authors are not part of any organization?,SELECT DISTINCT name FROM author WHERE oid IS NULL,academic,where
"What are the names of the authors who have written publications in the domain ""Computer Science""?",SELECT DISTINCT author.name FROM author join writes ON author.aid = writes.aid join publication ON writes.pid = publication.pid join domain_publication ON publication.pid = domain_publication.pid join domain ON domain_publication.did = domain.did WHERE domain.name ilike '%computer%science%';,academic,where
"Which organizations have authors who have written publications in the domain ""Machine Learning""?",SELECT DISTINCT organization.name  FROM organization  JOIN author ON organization.oid = author.oid  JOIN writes ON author.aid = writes.aid  JOIN domain_publication ON writes.pid = domain_publication.pid  JOIN domain ON domain_publication.did = domain.did  WHERE domain.name = 'Machine Learning';,academic,where
Which authors belong to the same domain as Martin?,SELECT DISTINCT a2.name FROM author a1 JOIN domain_author da1 ON a1.aid = da1.aid JOIN domain_author da2 ON da1.did = da2.did JOIN author a2 ON da2.aid = a2.aid WHERE LOWER(a1.name) LIKE '%martin%';,academic,where
What are the publications written by authors from the 'Artificial Intelligence' domain and presented at conferences in the year 2020?,SELECT DISTINCT publication.title FROM domain JOIN domain_author ON domain.did = domain_author.did JOIN writes ON domain_author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_conference ON domain.did = domain_conference.did WHERE domain.name = 'Artificial Intelligence' AND publication.year = 2020 AND publication.cid = domain_conference.cid;,academic,where
How many courses are offered in each semester?,"SELECT course_offering.semester, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM course_offering GROUP BY course_offering.semester ORDER BY course_offering.semester;",advising,group_by
How many courses have a final exam and how many do not?,"SELECT    course_offering.has_final_exam,    COUNT(*) AS num_courses FROM    course_offering GROUP BY    course_offering.has_final_exam;",advising,group_by
What is the total number of students who found the instructor to be hilarious per course?,"SELECT course_tags_count.course_id, SUM(course_tags_count.hilarious) AS total_hilarious FROM course_tags_count GROUP BY course_tags_count.course_id;",advising,group_by
How many courses does each department offer?,"SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC NULLS LAST;",advising,group_by
What is the average clarity score for each instructor who taught a course before?,"SELECT instructor.name, AVG(comment_instructor.score) as average_score FROM comment_instructor JOIN instructor ON comment_instructor.instructor_id = instructor.instructor_id GROUP BY instructor.name ORDER BY average_score DESC NULLS LAST;",advising,group_by
"What is the total number of students enrolled in each course, ordered from highest to lowest?","SELECT course.course_id, SUM(course.num_enrolled) AS total_students FROM course GROUP BY course.course_id ORDER BY total_students DESC NULLS LAST;",advising,order_by
"Which course has the highest number of enrolled students, and what is the enrollment number?","SELECT course.name, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1;",advising,order_by
"What is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits.","SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST;",advising,order_by
"What is the name of the instructor who has taught the most courses, and how many courses have they taught?","SELECT instructor.name, count(offering_instructor.offering_id) as num_courses FROM offering_instructor JOIN instructor ON offering_instructor.instructor_id = instructor.instructor_id GROUP BY instructor.name ORDER BY num_courses DESC LIMIT 1;",advising,order_by
"What is the total number of students who participated actively in each course, ordered from highest to lowest?","SELECT course_tags_count.course_id, course_tags_count.participation FROM course_tags_count ORDER BY course_tags_count.participation DESC NULLS LAST;",advising,order_by
What is the ratio of helpfulness scores to clarity scores for each course?,"SELECT    course.course_id,    CAST(course.helpfulness_score AS FLOAT) / NULLIF(course.clarity_score, 0) AS ratio FROM    course;",advising,ratio
How does the ratio of enrolled students to the number of reviews vary across different courses?,"SELECT    course.course_id,    CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS student_review_ratio FROM    course ORDER BY    student_review_ratio NULLS LAST;",advising,ratio
What is the ratio of the number of courses with projects to the number of courses with exams in each semester?,"SELECT    course_offering.semester,    CAST(SUM(CASE WHEN course.has_projects THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN course.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM    course  JOIN    course_offering ON course.course_id = course_offering.course_id GROUP BY    course_offering.semester ORDER BY    course_offering.semester NULLS LAST;",advising,ratio
What is the ratio of the number of students who found the grading criteria clear and easy to understand to the number of students who received good feedback from the instructor for each course?,"SELECT    course_tags_count.course_id,    CAST(course_tags_count.clear_grading AS FLOAT) / NULLIF(course_tags_count.good_feedback, 0) AS ratio FROM    course_tags_count ORDER BY    course_tags_count.course_id NULLS LAST;",advising,ratio
What is the ratio of the total number of students enrolled in courses with exams to the total number of students enrolled in courses without exams?,"SELECT    CAST(SUM(CASE WHEN course.has_exams THEN course.num_enrolled ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN NOT course.has_exams THEN course.num_enrolled ELSE 0 END), 0) AS ratio FROM    course;",advising,ratio
Which courses have a final project and a final exam?,SELECT DISTINCT course.name FROM course_offering JOIN course ON course_offering.course_id = course.course_id WHERE course_offering.has_final_project AND course_offering.has_final_exam;,advising,table_join
What is the total number of credits earned by students in each program?,"SELECT program.name, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY program.name;",advising,table_join
How many students have declared a major in each program?,"SELECT program.name, COUNT(student.student_id) AS number_of_students FROM student JOIN program ON student.program_id = program.program_id WHERE student.declare_major IS NOT NULL GROUP BY program.name ORDER BY number_of_students DESC;",advising,table_join
Which courses have been taken by students in the Computer Science program?,SELECT DISTINCT course.name AS course_name FROM student JOIN student_record ON student.student_id = student_record.student_id JOIN program ON student.program_id = program.program_id JOIN course ON student_record.course_id = course.course_id WHERE program.name = 'Computer Science';,advising,table_join
What is the total number of students who have taken a course with a final project or exam?,SELECT COUNT(DISTINCT student_record.student_id) AS total_students FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.has_final_project OR course_offering.has_final_exam;,advising,table_join
How many students have taken a course in-person vs. online?,"SELECT    student_record.how,    COUNT(DISTINCT student_record.student_id) AS num_students FROM    student_record WHERE    student_record.how IN ('in-person', 'online') GROUP BY    student_record.how;",advising,where
What are the names of all the courses offered by the department of Computer Science?,SELECT course.name  FROM course  WHERE course.department = 'Computer Science'  ORDER BY course.name ASC NULLS LAST;,advising,where
"How many students have declared a minor program, and what are their names? Order the results by the students' last names.","SELECT student.firstname, student.lastname FROM student WHERE student.minor IS NOT NULL ORDER BY student.lastname NULLS LAST;",advising,where
"What are the individual ratios of easiness scores to helpfulness scores for courses in the ""Computer Science"" department? return the names and the ratios.","SELECT name, cast(course.easiness_score as float) / nullif(course.helpfulness_score, 0) as ratio FROM course WHERE course.department ilike '%Computer Science%';",advising,where
"What is the average GPA of students in the program ""Computer Engineering""?",SELECT AVG(student.total_gpa)  FROM student  JOIN program ON student.program_id = program.program_id  WHERE LOWER(program.name) LIKE '%computer engineering%';,advising,where
What is the total cost of round-trip fares for each airline?,"SELECT fare.fare_airline, SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare GROUP BY fare.fare_airline ORDER BY total_round_trip_cost DESC;",atis,group_by
How many flights are there from each airport?,"SELECT flight.from_airport, COUNT(*) AS number_of_flights FROM flight GROUP BY flight.from_airport ORDER BY number_of_flights ASC NULLS LAST;",atis,group_by
"What is the average cost of a one-way trip for each fare, sorted in ascending order?","SELECT fare.fare_id, AVG(fare.one_direction_cost) AS average_cost FROM fare GROUP BY fare.fare_id ORDER BY average_cost ASC NULLS LAST;",atis,group_by
"How many meals are served in each compartment, sorted by the number of meals in descending order?","SELECT food_service.compartment, COUNT(food_service.meal_number) AS number_of_meals FROM food_service GROUP BY food_service.compartment ORDER BY number_of_meals DESC NULLS LAST;",atis,group_by
"What is the average cost of round-trip fares from Los Angeles (LAX) to Chicago (ORD)?","SELECT AVG(fare.round_trip_cost) AS average_cost FROM fare WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY fare.from_airport, fare.to_airport;",atis,group_by
Which aircraft can carry the highest weight of cargo that any aircraft can carry?,"SELECT aircraft.aircraft_code, aircraft.pay_load FROM aircraft ORDER BY pay_load DESC NULLS LAST LIMIT 1;",atis,order_by
"Which flights to Chicago (ORD) have the longest duration from departure to arrival, sorted in ascending order?","SELECT flight.flight_id, (flight.arrival_time - flight.departure_time) AS duration FROM flight WHERE to_airport = 'ORD' ORDER BY duration ASC NULLS LAST;",atis,order_by
What are the top 2 airlines with the most flights?,"SELECT airline.airline_name, COUNT(flight.flight_id) AS number_of_flights FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY airline.airline_name ORDER BY number_of_flights DESC NULLS LAST LIMIT 2;",atis,order_by
"Which airports have the shortest minimum connect time, sorted in ascending order?","SELECT airport.airport_name, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST;",atis,order_by
"What are the aircraft codes for all aircraft with a cruising speed of over 200 mph, sorted in ascending order?",SELECT aircraft.aircraft_code FROM aircraft WHERE aircraft.cruising_speed > 200 ORDER BY aircraft.aircraft_code ASC;,atis,order_by
What is the ratio of one-way trip costs to round-trip costs for each fare?,"SELECT fare.fare_id,         fare.one_direction_cost::float / NULLIF(fare.round_trip_cost, 0) AS cost_ratio FROM fare ORDER BY cost_ratio;",atis,ratio
What is the ratio of the weight of an aircraft to its maximum payload capacity?,"SELECT aircraft.weight::float / NULLIF(aircraft.pay_load, 0) AS weight_to_payload_ratio FROM aircraft;",atis,ratio
How does the ratio of the cruising speed to the payload of an aircraft vary across different aircraft manufacturers?,"SELECT    aircraft.manufacturer,    AVG(CAST(aircraft.cruising_speed AS FLOAT) / NULLIF(aircraft.pay_load, 0)) AS speed_payload_ratio FROM    aircraft GROUP BY    aircraft.manufacturer ORDER BY    speed_payload_ratio DESC NULLS LAST;",atis,ratio
What is the proportion of flights with stops out of all flights for each airline code?,"SELECT    flight.airline_code,    CAST(SUM(CASE WHEN flight.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio FROM    flight GROUP BY    flight.airline_code;",atis,ratio
What is the ratio of aircraft capacity to its range in miles for each aircraft code?,"SELECT aircraft.aircraft_code,         CAST(aircraft.capacity AS FLOAT) / NULLIF(aircraft.range_miles, 0) AS capacity_range_ratio FROM aircraft;",atis,ratio
Which airlines offer flights from LAX to ORD?,SELECT DISTINCT airline.airline_name FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD';,atis,table_join
Which flights serve meals in first class? Give me the flight id and meal description.,"SELECT flight.flight_id, food_service.meal_description FROM flight JOIN food_service ON flight.meal_code = food_service.meal_code WHERE LOWER(food_service.compartment) LIKE '%first class%';",atis,table_join
Which airlines offer flights with a stopover in Dallas?,SELECT DISTINCT airline.airline_name FROM flight_stop JOIN airport ON flight_stop.stop_airport = airport.airport_code JOIN flight ON flight_stop.flight_id = flight.flight_id JOIN airline ON flight.airline_code = airline.airline_code WHERE airport.airport_location = 'Dallas';,atis,table_join
Which airlines do not have flights that depart or arrive at JFK?,SELECT DISTINCT a.airline_name FROM public.airline a LEFT JOIN public.flight f ON a.airline_code = f.airline_code AND (f.to_airport = 'JFK' OR f.from_airport = 'JFK') GROUP BY 1 HAVING COUNT(f.flight_id) = 0;,atis,table_join
"Which airlines offer flights from Chicago (ORD) to New York (JFK), and how many stops do they have, sorted by number of stops?","SELECT    airline.airline_name,    flight.stops FROM    flight JOIN    airline ON flight.airline_code = airline.airline_code WHERE    flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' GROUP BY    airline.airline_name,    flight.stops ORDER BY    flight.stops NULLS LAST;",atis,table_join
What is the total cost of a round-trip fare from New York (JFK) to Los Angeles?,SELECT SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare WHERE fare.from_airport = 'JFK' AND fare.to_airport = 'LAX';,atis,where
What is the minimum amount of time required for a connecting flight at JFK Airport?,SELECT minimum_connect_time  FROM airport  WHERE airport_code = 'JFK';,atis,where
How many flights require a round-trip to purchase the fare?,SELECT COUNT(*)  FROM fare  WHERE round_trip_required = 'Yes';,atis,where
Which flights operate on Mondays and Wednesdays? Give me the relevant flight numbers,SELECT flight.flight_number FROM flight WHERE LOWER(flight.flight_days) LIKE '%mon%' AND LOWER(flight.flight_days) LIKE '%wed%';,atis,where
Which state is Orlando International Airport in?,SELECT state_code  FROM airport  WHERE airport_name = 'Orlando International Airport';,atis,where
How many rivers flow through each country?,"SELECT river.country_name, COUNT(DISTINCT river.river_name) AS number_of_rivers FROM river GROUP BY river.country_name ORDER BY number_of_rivers DESC;",geography,group_by
What is the total population of each country in the database?,"SELECT city.country_name, SUM(city.population) AS total_population FROM city GROUP BY city.country_name ORDER BY total_population DESC NULLS LAST;",geography,group_by
How many lakes are there in each state?,"SELECT lake.state_name, COUNT(lake.lake_name) AS lake_count FROM lake GROUP BY lake.state_name ORDER BY lake_count DESC;",geography,group_by
What is the average length of rivers in each country?,"SELECT    river.country_name,    AVG(river.length) AS average_length FROM    river GROUP BY    river.country_name ORDER BY    average_length DESC NULLS LAST;",geography,group_by
How many mountains are there in each country?,"SELECT mountain.country_name, COUNT(mountain.mountain_name) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC;",geography,group_by
"Which lakes have the largest areas in square kilometers, ordered from largest to smallest?","SELECT lake.lake_name, lake.area FROM lake ORDER BY lake.area DESC NULLS LAST;",geography,order_by
"What are the longest rivers in meters, ordered from longest to shortest?","SELECT river.river_name, river.length FROM river ORDER BY river.length DESC NULLS LAST;",geography,order_by
"Which states have the highest population density in people per square kilometer, ordered from highest to lowest?","SELECT state.state_name, state.density FROM state ORDER BY state.density DESC NULLS LAST;",geography,order_by
"What are the highest mountains in meters, ordered from highest to lowest altitude?","SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST;",geography,order_by
What are the top 5 cities with the highest population?,"SELECT city.city_name, city.population FROM city ORDER BY city.population DESC NULLS LAST LIMIT 5;",geography,order_by
Get the ratio of population per area for each state,"SELECT state_name, population / area AS population_density FROM state;",geography,ratio
"How does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state.","SELECT city.city_name, CAST(city.population AS float) / NULLIF(state.population, 0) AS population_ratio FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_ratio DESC NULLS LAST;",geography,ratio
What is the ratio of the population of the United States to the population of California?,"SELECT    CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.country_name) LIKE '%united states%') AS FLOAT) /    CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.state_name) LIKE '%california%') AS FLOAT) AS population_ratio FROM    state;",geography,ratio
What is the ratio of the length of the Mississippi River to the length of the Rhine River?,"SELECT    CAST((SELECT length FROM river WHERE LOWER(river_name) LIKE '%mississippi%') AS FLOAT) / NULLIF((SELECT length FROM river WHERE LOWER(river_name) LIKE '%rhine%'), 0) AS ratio ;",geography,ratio
What is the ratio of the altitude of Mount Everest to the altitude of Dhaulagiri?,"SELECT    (CAST(everest.mountain_altitude AS FLOAT) / NULLIF(dhaulagiri.mountain_altitude, 0)) AS altitude_ratio FROM    (SELECT mountain_altitude FROM mountain WHERE LOWER(mountain_name) LIKE '%mount everest%') AS everest,   (SELECT mountain_altitude FROM mountain WHERE LOWER(mountain_name) LIKE '%dhaulagiri%') AS dhaulagiri;",geography,ratio
What is the highest point in each state and what is the population density of that state?,"SELECT    highlow.state_name,    highlow.highest_point,    state.density FROM    highlow JOIN    state ON highlow.state_name = state.state_name GROUP BY    highlow.state_name,    highlow.highest_point,    state.density;",geography,table_join
Which cities are not associated with any state?,SELECT city.city_name FROM city LEFT JOIN state ON city.state_name = state.state_name WHERE state.state_name IS NULL;,geography,table_join
Which countries have lakes and rivers?,SELECT DISTINCT lake.country_name FROM public.lake JOIN public.river ON lake.country_name = river.country_name; ,geography,table_join
What is the average length of rivers per country in countries with a lake?,"SELECT l.country_name, AVG(r.length) AS average_length FROM river r JOIN lake l ON r.country_name = l.country_name GROUP BY 1;",geography,table_join
What is the ratio of the area of each lake to the total area of the state it is located in?,"SELECT lake.lake_name, lake.area / NULLIF(state.area, 0) AS ratio FROM lake JOIN state ON lake.state_name = state.state_name;",geography,table_join
Get the cities in the United States and their population ,"SELECT city_name, population FROM city WHERE country_name = 'United States'; ",geography,where
What are the areas of the lakes in Michigan?,"SELECT lake_name, area FROM lake WHERE state_name = 'Michigan';",geography,where
What are the names and altitudes of the mountains in Nepal?,"SELECT mountain_name, mountain_altitude FROM mountain WHERE country_name = 'Nepal'; ",geography,where
Which rivers traverse at least 3 cities/landmarks?,"SELECT river_name, length FROM river WHERE traverse LIKE '%,%,%'; ",geography,where
Which states have fewer than a hundred thousand people?,SELECT state_name FROM state WHERE population < 100000;,geography,where
What is the total count of restaurants in each city?,"SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS total_count FROM location GROUP BY location.city_name;",restaurants,group_by
What is the average rating of restaurants serving each type of food?,"SELECT    restaurant.food_type,    AVG(restaurant.rating) AS average_rating FROM    restaurant GROUP BY    restaurant.food_type ORDER BY    average_rating DESC NULLS LAST;",restaurants,group_by
How many restaurants are there in each city? Order the results by the number of restaurants in descending order.,"SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants FROM location GROUP BY location.city_name ORDER BY number_of_restaurants DESC NULLS LAST;",restaurants,group_by
What is the total number of restaurants serving each type of food?,"SELECT restaurant.food_type, COUNT(DISTINCT restaurant.id) AS total_number_of_restaurants FROM restaurant GROUP BY restaurant.food_type;",restaurants,group_by
How many restaurants serve Italian food in each city?,"SELECT location.city_name, COUNT(*) AS number_of_restaurants FROM location JOIN restaurant ON location.restaurant_id = restaurant.id WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY location.city_name ORDER BY number_of_restaurants DESC NULLS LAST;",restaurants,group_by
What are the names of the top 3 restaurants with the highest ratings?,SELECT restaurant.name FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST LIMIT 3;,restaurants,order_by
Which restaurants serve Italian cuisine or are located in New York City? Order the results by the restaurant name.,SELECT restaurant.name  FROM restaurant  JOIN location ON restaurant.id = location.restaurant_id  WHERE restaurant.food_type = 'Italian' OR location.city_name = 'New York'  ORDER BY restaurant.name NULLS LAST;,restaurants,order_by
What is the average rating of restaurants in each region? Order the results by the region name.,"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name GROUP BY geographic.region ORDER BY geographic.region NULLS LAST;",restaurants,order_by
Which street has the most number of restaurants?,SELECT DISTINCT location.street_name FROM location WHERE street_name = (SELECT street_name FROM location GROUP BY 1 ORDER BY COUNT(restaurant_id) DESC LIMIT 1);,restaurants,order_by
List the restaurants starting from the best ratings to the lowest,"SELECT {name, id}, rating FROM restaurant ORDER BY rating DESC; ",restaurants,order_by
What is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall?,"SELECT CAST(SUM(CASE WHEN restaurant.rating > 4.0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN restaurant.rating < 4.0 THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant;",restaurants,ratio
What is the ratio of Italian restaurants out of all restaurants in Los Angeles?,"SELECT CAST(COUNT(CASE WHEN food_type = 'Italian' THEN 1 END) AS FLOAT) / NULLIF(COUNT(food_type), 0) AS ratio FROM    restaurant WHERE    city_name = 'Los Angeles';",restaurants,ratio
What is the ratio of restaurants serving vegan food to restaurants serving non-vegan food in San Francisco?,"SELECT    CAST(SUM(CASE WHEN LOWER(restaurant.food_type) LIKE '%vegan%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN LOWER(restaurant.food_type) NOT LIKE '%vegan%' THEN 1 ELSE 0 END), 0) AS ratio FROM    restaurant WHERE    LOWER(restaurant.city_name) = 'san francisco';",restaurants,ratio
What is the ratio of restaurants with a rating above 4 to restaurants with a rating below 4 in New York?,"SELECT    CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio FROM    restaurant WHERE    city_name ILIKE 'New York';",restaurants,ratio
What is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database.,SELECT COUNT(*)::float / (SELECT COUNT(*) FROM restaurant) AS rating_ratio FROM restaurant WHERE rating > 4.5;,restaurants,ratio
What is the average rating of restaurants in each region?,"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name=restaurant.city_name GROUP BY 1;",restaurants,table_join
How many restaurants serve Italian food in each region?,"SELECT geographic.region, COUNT(restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE LOWER(restaurant.food_type) LIKE '%italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC NULLS LAST;",restaurants,table_join
How many restaurants are there in each region?,"SELECT geographic.region, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants FROM geographic JOIN location ON geographic.city_name = location.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;",restaurants,table_join
What is the average rating of restaurants that serve Mexican food in each city?,"SELECT location.city_name, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN location ON restaurant.id = location.restaurant_id WHERE LOWER(restaurant.food_type) LIKE '%mexican%' GROUP BY location.city_name;",restaurants,table_join
Which restaurants have the same name in each city, and what is the count?,"SELECT r.city_name, r.name, COUNT(*) as restaurant_count FROM restaurant r GROUP BY r.city_name, r.name HAVING COUNT(*) > 1;",restaurants,table_join
Which city has the highest-rated restaurant?,SELECT DISTINCT restaurant.city_name FROM restaurant WHERE rating=(SELECT MAX(rating) FROM restaurant);,restaurants,where
What are the names of the restaurants in Los Angeles that have a rating higher than 4?,SELECT DISTINCT restaurant.name FROM restaurant WHERE restaurant.city_name = 'Los Angeles' AND restaurant.rating > 4 ORDER BY restaurant.name NULLS LAST;,restaurants,where
What are the names of the restaurants that serve Italian food?,SELECT restaurant.name FROM restaurant WHERE LOWER(restaurant.food_type) = 'italian' ORDER BY restaurant.rating DESC NULLS LAST;,restaurants,where
What's the name and food type of all the restaurants located on Market St in San Francisco?,"SELECT restaurant.name, restaurant.food_type FROM restaurant JOIN location ON restaurant.id = location.restaurant_id WHERE location.street_name = 'Market St' AND location.city_name = 'San Francisco';",restaurants,where
What's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York?,"SELECT {restaurant.name, restaurant.id}, restaurant.rating FROM restaurant WHERE restaurant.rating > 4 AND restaurant.city_name = 'New York';",restaurants,where
What is the total number of papers published in each year?,"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year;",scholar,group_by
What is the total number of papers associated with each dataset?,"SELECT paperdataset.datasetid, COUNT(DISTINCT paperdataset.paperid) AS total_papers FROM paperdataset GROUP BY paperdataset.datasetid;",scholar,group_by
How many keyphrases are associated with each paper?,"SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY keyphrase_count DESC NULLS LAST;",scholar,group_by
What is the total number of papers published per year?,"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year NULLS LAST;",scholar,group_by
How many authors have published more than 2 papers?,SELECT COUNT(*) AS number_of_authors FROM (   SELECT writes.authorid   FROM writes   GROUP BY writes.authorid   HAVING COUNT(writes.paperid) > 2 ) AS subquery;,scholar,group_by
"How many papers cite each paper in the database, ordered by the number of citations in descending order?","SELECT cite.citingpaperid, COUNT(*) AS citation_count FROM cite GROUP BY cite.citingpaperid ORDER BY citation_count DESC NULLS LAST;",scholar,order_by
"What is the total number of keyphrases associated with each paper, ordered by the paper ID in ascending order?","SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS total_keyphrases FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY paperkeyphrase.paperid ASC NULLS LAST;",scholar,order_by
"Which papers have the highest number of authors, ordered by the number of authors in descending order?","SELECT writes.paperid, COUNT(writes.authorid) AS num_authors FROM writes GROUP BY writes.paperid ORDER BY num_authors DESC NULLS LAST;",scholar,order_by
"What are the titles of the papers published in the year 2020, ordered alphabetically?",SELECT paper.title FROM paper WHERE paper.year = 2020 ORDER BY paper.title ASC NULLS LAST;,scholar,order_by
"What are the names of the journals in the database, ordered by the length of the journal name from shortest to longest?",SELECT journal.journalname FROM journal ORDER BY LENGTH(journal.journalname) ASC NULLS LAST;,scholar,order_by
What is the ratio of papers published in the year 2020 to the total number of papers in the database?,"SELECT    CAST(COUNT(CASE WHEN paper.year = 2020 THEN 1 END) AS FLOAT) / NULLIF(COUNT(paper.paperid), 0) AS ratio FROM    paper;",scholar,ratio
What is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers?,"SELECT    CAST(COUNT(CASE WHEN paper.numcitedby > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN paper.numcitedby < 2 THEN 1 END), 0) AS ratio FROM    paper;",scholar,ratio
What is the ratio of authors who have written 3 or more papers to authors who have written less than 3 papers?,"SELECT    CAST(COUNT(DISTINCT CASE WHEN paper_count >= 3 THEN subquery.authorid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN paper_count < 3 THEN subquery.authorid END), 0) AS ratio FROM (   SELECT      writes.authorid,      COUNT(writes.paperid) AS paper_count   FROM      writes   GROUP BY      writes.authorid ) AS subquery;",scholar,ratio
What is the proportion of papers that belong to more than 1 dataset to papers that belong to1 dataset?,"SELECT    CAST(COUNT(CASE WHEN dataset_count > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN dataset_count = 1 THEN 1 END), 0) AS ratio FROM (   SELECT      paperdataset.paperid,      COUNT(paperdataset.datasetid) AS dataset_count   FROM      paperdataset   GROUP BY      paperdataset.paperid ) AS subquery;",scholar,ratio
What is the ratio of papers that have more than 1 keyphrases to papers that have 1 keyphrase?,"SELECT    CAST(COUNT(DISTINCT CASE WHEN keyphrase_count > 1 THEN subquery.paperid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN keyphrase_count =1  THEN subquery.paperid END), 0) AS ratio FROM (   SELECT      paperkeyphrase.paperid,      COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count   FROM      paperkeyphrase   GROUP BY      paperkeyphrase.paperid ) AS subquery;",scholar,ratio
"How many papers cite each paper in the dataset named ""COVID-19 Research""?","SELECT paperdataset.paperid, COUNT(cite.citedpaperid) AS citation_count FROM paperdataset JOIN cite ON paperdataset.paperid = cite.citedpaperid WHERE paperdataset.datasetid = (SELECT datasetid FROM dataset WHERE datasetname = 'COVID-19 Research') GROUP BY paperdataset.paperid ORDER BY citation_count DESC;",scholar,table_join
"What is the total number of unique keyphrases associated with papers published in the journal named ""IEEE Transactions""?",SELECT COUNT(DISTINCT paperkeyphrase.keyphraseid) AS total_keyphrases FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid WHERE journal.journalname ILIKE '%IEEE Transactions%';,scholar,table_join
"What is the total number of papers published in each journal, ordered by the journal name?","SELECT {journal.journalname, journal.journalid}, COUNT(DISTINCT paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid GROUP BY {} ORDER BY journal.journalname NULLS LAST;",scholar,table_join
"Which authors have published the most papers, ordered by the number of papers they have published in descending order?","SELECT {author.authorname, author.authorid}, COUNT(DISTINCT writes.paperid) AS number_of_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY {} ORDER BY number_of_papers DESC NULLS LAST;",scholar,table_join
"Which papers are associated with the keyphrase ""Machine Learning""?",SELECT {paper.title,paper.id}  FROM paper  JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid  JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid  WHERE keyphrase.keyphrasename = 'Machine Learning';,scholar,table_join
"How many papers are associated with the keyphrase ""machine learning"" and were published in the journal named ""IEEE Transactions on Pattern Analysis and Machine Intelligence""?",SELECT COUNT(DISTINCT paper.paperid)  FROM paper  JOIN journal ON paper.journalid = journal.journalid  JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid  JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid  WHERE keyphrase.keyphrasename ILIKE '%machine learning%'  AND journal.journalname ILIKE '%IEEE Transactions on Pattern Analysis and Machine Intelligence%';,scholar,where
"What is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue?","SELECT venue.venuename, COUNT(DISTINCT paper.paperid)  FROM paper  JOIN venue ON paper.venueid = venue.venueid  WHERE paper.venueid = (   SELECT venueid    FROM paper    WHERE paperid = 2 )  GROUP BY venue.venuename;",scholar,where
"What are the names of the authors who wrote the paper with the title ""The Effects of Climate Change on Agriculture""?",SELECT author.authorname  FROM author  JOIN writes ON author.authorid = writes.authorid  JOIN paper ON writes.paperid = paper.paperid  WHERE paper.title ILIKE '%The Effects of Climate Change on Agriculture%';,scholar,where
"How many papers were published in the journal ""nature"" in the year 2020?",SELECT COUNT(paper.paperid)  FROM paper  JOIN journal ON paper.journalid = journal.journalid  WHERE paper.year = 2020 AND journal.journalname ILIKE '%nature%';,scholar,where
"How many authors wrote papers that were published in the journal ""Science"" in the year 2020?",SELECT COUNT(DISTINCT writes.authorid) AS number_of_authors FROM writes JOIN paper ON writes.paperid = paper.paperid JOIN journal ON paper.journalid = journal.journalid WHERE journal.journalname ILIKE '%Science%' AND paper.year = 2020;,scholar,where
How many check-ins occurred on each day of the week?,"SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;",yelp,group_by
What is the total count of check-ins for each business id?,"SELECT checkin.business_id, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.business_id ORDER BY total_checkins DESC NULLS LAST;",yelp,group_by
"Which neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood?","SELECT {neighbourhood.neighbourhood_name, neighbourhood.id}, COUNT(DISTINCT neighbourhood.business_id) AS business_count FROM neighbourhood GROUP BY {} ORDER BY business_count DESC NULLS LAST;",yelp,group_by
"What is the total number of check-ins for each day of the week for the business with ID ""abc123""?","SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.business_id = 'abc123' GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;",yelp,group_by
What is the average rating of each business in the city of NEW YORK?,"SELECT    {business.name, business.business_id, business.bid},    business.rating AS average_rating FROM    business WHERE    business.city ILIKE '%NEW YORK%' GROUP BY    {};",yelp,group_by
"How many reviews were posted in each month of the year 2021, ordered by the month?","SELECT review.month, COUNT(review.rid) AS review_count FROM review WHERE review.year = 2021
GROUP BY review.month ORDER BY TO_DATE(review.month, 'MONTH') NULLS LAST;",yelp,order_by
"What are the names of the businesses in the database, ordered alphabetically?",SELECT business.name  FROM business  ORDER BY business.name ASC NULLS LAST;,yelp,order_by
What is the latitude and longitude of the business with the highest rating?,"SELECT business.latitude, business.longitude FROM business ORDER BY business.rating DESC NULLS LAST LIMIT 1;",yelp,order_by
What are the top 3 businesses in terms of review count?,"SELECT {business.name, business.business_id, business.bid}, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3;",yelp,order_by
"Which businesses have the highest average rating in the city of ""New York"" and what are their names?","SELECT business.name, business.rating FROM business WHERE business.city ILIKE '%New York%' ORDER BY business.rating DESC NULLS LAST;",yelp,order_by
What is the ratio of open businesses to closed businesses in the city of San Francisco?,"SELECT    CAST(SUM(CASE WHEN business.is_open = 1 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN business.is_open = 0 THEN 1 ELSE 0 END), 0) AS ratio FROM    business WHERE    LOWER(business.city) ILIKE '%san francisco%';",yelp,ratio
"How does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio?","SELECT    {category.category_name, category.id},    CAST(COUNT(CASE WHEN review.rating > 3 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 END), 0) AS ratio FROM    review JOIN    category ON review.business_id = category.business_id GROUP BY    {} ORDER BY    ratio DESC NULLS LAST;",yelp,ratio
What is the ratio of the number of businesses in each state to the total number of businesses in the database?,"SELECT    business.state,    COUNT(business.business_id) / NULLIF(CAST((SELECT COUNT(*) FROM business) AS FLOAT), 0) AS ratio FROM    business GROUP BY    business.state;",yelp,ratio
"What is the ratio of check-ins on weekends to check-ins on weekdays for the business named ""Mark's Bistro""?","SELECT    CAST(SUM(CASE WHEN checkin.day IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN checkin.day NOT IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END), 0) AS ratio FROM    checkin JOIN    business ON checkin.business_id = business.business_id WHERE    business.name ILIKE '%Mark''s Bistro%';",yelp,ratio
What is the ratio of businesses in the state of California to businesses in the state of New York?,"SELECT    CAST(COUNT(CASE WHEN business.state = 'CA' THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN business.state = 'NY' THEN 1 END), 0) AS ratio FROM    business;",yelp,ratio
What is the total number of reviews for each business category?,"SELECT {category.category_name, category.id}, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id GROUP BY {} ORDER BY total_reviews DESC NULLS LAST;",yelp,table_join
What are the top 2 categories of businesses with the highest average rating?,"SELECT {category.category_name, dategory.id}, AVG(business.rating) AS average_rating FROM category JOIN business ON category.business_id = business.business_id GROUP BY {} ORDER BY average_rating DESC NULLS LAST LIMIT 2;",yelp,table_join
"What is the total number of reviews for each category in the state of ""California""?","SELECT {category.category_name, category.id}, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id WHERE business.state = 'CA' GROUP BY {} ORDER BY total_reviews DESC NULLS LAST;",yelp,table_join
"Which users have posted reviews for businesses located in the neighbourhood of ""Downtown"" and how many reviews have they posted?","SELECT {users.name, users.user_id}, COUNT(review.rid) as review_count FROM review JOIN neighbourhood ON review.business_id = neighbourhood.business_id JOIN users ON review.user_id = users.user_id WHERE neighbourhood.neighbourhood_name ILIKE '%Downtown%' GROUP BY {} ORDER BY review_count DESC NULLS LAST;",yelp,table_join
What is the total number of check-ins for each business in the state of California?,"SELECT    {business.business_id, business.name, business.bid},    SUM(checkin.count) AS total_checkins FROM    business  JOIN    checkin  ON    business.business_id = checkin.business_id WHERE    business.state = 'CA' GROUP BY    {} ORDER BY    total_checkins DESC NULLS LAST;",yelp,table_join
How many reviews were posted for each business id in the year 2021?,"SELECT review.business_id, COUNT(*) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.business_id ORDER BY review_count DESC NULLS LAST;",yelp,where
How many check-ins occurred on Mondays at businesses in the state of California?,SELECT SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' AND checkin.day = 'Monday';,yelp,where
"What is the total number of reviews posted in the year 2021 for businesses in the category ""Cafe""?",SELECT COUNT(review.rid) AS total_reviews FROM review JOIN category ON review.business_id = category.business_id WHERE review.year = 2021 AND category.category_name ILIKE '%Cafe%';,yelp,where
"How many reviews were posted by users with the name ""John Doe"" in the month of April?",SELECT COUNT(*)  FROM review  JOIN users ON review.user_id = users.user_id  WHERE users.name ILIKE '%John Doe%' AND review.month ILIKE '%April%';,yelp,where
What is the average rating of businesses in the city of San Francisco?,SELECT AVG(business.rating)  FROM business  WHERE LOWER(business.city) = 'san francisco';,yelp,where